<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>proteinatlas.org expression heatmap — proteinatlas_heatmap • pajam</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="proteinatlas.org expression heatmap — proteinatlas_heatmap" />
<meta property="og:description" content="proteinatlas.org expression heatmap" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pajam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/pajam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>proteinatlas.org expression heatmap</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/pajam/blob/master/R/pajam-heatmap.R'><code>R/pajam-heatmap.R</code></a></small>
    <div class="hidden name"><code>proteinatlas_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>proteinatlas.org expression heatmap</p>
    </div>

    <pre class="usage"><span class='fu'>proteinatlas_heatmap</span><span class='op'>(</span>
  expr <span class='op'>=</span> <span class='va'>proteinatlas_expr_fdb11</span>,
  genes <span class='op'>=</span> <span class='cn'>NULL</span>,
  samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"all"</span>, <span class='st'>"Tissue"</span>, <span class='st'>"Cell"</span>, <span class='st'>"Blood"</span>, <span class='st'>"Brain"</span><span class='op'>)</span>,
  row_cex <span class='op'>=</span> <span class='fl'>1</span>,
  column_cex <span class='op'>=</span> <span class='fl'>1</span>,
  ramp <span class='op'>=</span> <span class='st'>"Reds"</span>,
  lens <span class='op'>=</span> <span class='fl'>0</span>,
  color_ceiling <span class='op'>=</span> <span class='cn'>NULL</span>,
  cluster_columns <span class='op'>=</span> <span class='cn'>FALSE</span>,
  cluster_rows <span class='op'>=</span> <span class='cn'>FALSE</span>,
  column_split <span class='op'>=</span> <span class='cn'>NULL</span>,
  row_split <span class='op'>=</span> <span class='cn'>NULL</span>,
  centered <span class='op'>=</span> <span class='cn'>FALSE</span>,
  row_filter <span class='op'>=</span> <span class='fl'>0</span>,
  column_filter <span class='op'>=</span> <span class='fl'>0</span>,
  controlSamples <span class='op'>=</span> <span class='cn'>NULL</span>,
  gene_names <span class='op'>=</span> <span class='cn'>FALSE</span>,
  gene_im <span class='op'>=</span> <span class='cn'>NULL</span>,
  gene_im_colors <span class='op'>=</span> <span class='cn'>NULL</span>,
  left_annotation <span class='op'>=</span> <span class='cn'>NULL</span>,
  fill_missing <span class='op'>=</span> <span class='cn'>TRUE</span>,
  border <span class='op'>=</span> <span class='cn'>TRUE</span>,
  useCenterGroups <span class='op'>=</span> <span class='cn'>TRUE</span>,
  trim_columns <span class='op'>=</span> <span class='cn'>FALSE</span>,
  rowStatsFunc <span class='op'>=</span> <span class='fu'>matrixStats</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/matrixStats/man/rowRanges.html'>rowMins</a></span>,
  return_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"heatmap"</span>, <span class='st'>"list"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>expr</th>
      <td><p><code>numeric</code> matrix containing gene rows, and
biological sample columns.</p></td>
    </tr>
    <tr>
      <th>genes</th>
      <td><p><code>character</code> vector of genes to display. These values
are matched case-insensitive to the start of values in
<code><a href='https://rdrr.io/r/base/colnames.html'>rownames(expr)</a></code>, in order to facilitate pattern-matching.
Specifically, the input is passed to
<code><a href='https://rdrr.io/pkg/jamba/man/provigrep.html'>jamba::provigrep(c(genes), rownames(expr))</a></code> which iteratively
matches each input <code>genes</code> using case-insensitive <code><a href='https://rdrr.io/r/base/grep.html'>grep()</a></code>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code>character</code> vector of one or more expression types
to include, where <code>"all"</code> includes all columns in <code>expr</code>.</p></td>
    </tr>
    <tr>
      <th>row_cex, column_cex</th>
      <td><p><code>numeric</code> value used to adjust row and
column text size, where <code>1</code> is the default size. Text size is
auto-scaled based upon the number of rows and columns being
displayed; these values adjust the auto-scaled font size.</p></td>
    </tr>
    <tr>
      <th>ramp</th>
      <td><p><code>character</code> name of a color ramp, or a <code>character</code>
vector of R colors, used to create a color ramp.</p></td>
    </tr>
    <tr>
      <th>lens</th>
      <td><p><code>numeric</code> value used to adjust the intensity of
the color ramp, where values &gt; 0 make colors change earlier,
and values &lt; 0 make colors change later.</p></td>
    </tr>
    <tr>
      <th>color_ceiling</th>
      <td><p><code>numeric</code> value indicating the maximum used
for the color gradient, using units as displayed on the heatmap
(exponentiated.) If <code>NULL</code> then the maximum value is used.</p></td>
    </tr>
    <tr>
      <th>cluster_columns, cluster_rows</th>
      <td><p><code>logical</code> indicating whether to
cluster columns and rows, respectively.</p></td>
    </tr>
    <tr>
      <th>centered</th>
      <td><p><code>logical</code> indicating whether data should be centered
by the median expression across all samples. Note that median
expression in many cases is zero, for genes not widely expressed
across all samples being displayed.</p></td>
    </tr>
    <tr>
      <th>column_filter, row_filter</th>
      <td><p>numeric value which hides columns or
rows when the column or row maximum expression is not at or above
this numeric threshold. The value filtered is the expression value
indicated on the heatmap, the normal expression value, not
log2-transformed.</p></td>
    </tr>
    <tr>
      <th>controlSamples</th>
      <td><p><code>character</code> vector, or <code>NULL</code>, indicating
specific samples to use when centering data by row. When
<code>controlSamples=NULL</code>, the default is to use all Tissue samples.</p></td>
    </tr>
    <tr>
      <th>gene_names</th>
      <td><p><code>logical</code> indicating whether to display full gene
names, provided using <code><a href='https://rdrr.io/pkg/genejam/man/freshenGenes.html'>genejam::freshenGenes()</a></code>.</p></td>
    </tr>
    <tr>
      <th>gene_im</th>
      <td><p><code>matrix</code> intended to be an incidence matrix, whose
values are <code>0</code> and <code>1</code>, with gene symbols as rownames, and various
columns indicating different annotations. When a rowname in the
heatmap is not found in the incidence matrix,
it subtitutes <code>0</code> to fill the empty space. See examples to see how
to use the <code>proteinatlas_genesets_fdb11</code> data.</p></td>
    </tr>
    <tr>
      <th>gene_im_colors</th>
      <td><p><code>function</code> or <code>vector</code> that contains data
to define colors for <code>gene_im</code>, using methods sufficient for
<code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html'>ComplexHeatmap::HeatmapAnnotation()</a></code>. When <code>gene_im_colors</code> is
<code>NULL</code> a default function is used which is intended only for
<code><a href='https://rdrr.io/r/base/c.html'>c(0, 1)</a></code>.</p></td>
    </tr>
    <tr>
      <th>left_annotation</th>
      <td><p>optional heatmap annotation as produced
by <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html'>ComplexHeatmap::HeatmapAnnotation()</a></code>, as an alternative to
supplying <code>gene_im</code>. Note than when <code>gene_im</code> is supplied,
it will replace <code>left_annotation</code>. This option is available
only to allow supplying a customized side annotation.</p></td>
    </tr>
    <tr>
      <th>fill_missing</th>
      <td><p><code>logical</code> indicating whether the input <code>genes</code> should
bo used as-is with no pattern matching, and by substituting <code>0</code>
for any missing entries. This argument is useful when trying to
align this heatmap with another existing <code>Heatmap</code> object, where
the rows must be exactly aligned.</p></td>
    </tr>
    <tr>
      <th>border</th>
      <td><p><code>logical</code> indicating whether to draw a heatmap border.</p></td>
    </tr>
    <tr>
      <th>useCenterGroups</th>
      <td><p><code>logical</code> used when <code>centered=TRUE</code>, and when
<code>controlSamples</code> are provided, will center each sample type
independently, instead of centering all samples versus <code>"Tissue"</code>
type. We decided by default to center all samples versus <code>"Tissue"</code>
by default, because some immune-specific genes are highly expressed
in all <code>"Blood"</code> samples but not <code>"Tissue"</code>, and it was visually
confusing.</p></td>
    </tr>
    <tr>
      <th>trim_columns</th>
      <td><p><code>logical</code> indicating whether to trim the colnames
to remove the sample type suffix.</p></td>
    </tr>
    <tr>
      <th>rowStatsFunc</th>
      <td><p><code>function</code> used to define the per-row value used
when <code>centered=TRUE</code>, passed to <code><a href='https://rdrr.io/pkg/jamma/man/centerGeneData_new.html'>jamma::centerGeneData_new()</a></code>.
The default is to use the <code><a href='https://rdrr.io/pkg/matrixStats/man/rowRanges.html'>matrixStats::rowMins()</a></code> which returns
the minimum expression value per row.</p></td>
    </tr>
    <tr>
      <th>return_type</th>
      <td><p><code>character</code> string indicating the type of return
object: <code>"heatmap"</code> returns the <code>Heatmap</code> object sufficient to
be plotted using <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html'>ComplexHeatmap::draw()</a></code>; <code>"list"</code> returns <code>list</code>
of relevant data components used to produce the heatmap, sufficient
for reviewing more details. The <code>list</code> output also includes data
actually used in the heatmap, after the expression centering,
expression filtering, and sample subsetting, as relevant.
if relevant.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code> indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are passed to <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>
for other customizations.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>Heatmap</code> produced by <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code> by default,
when <code>return_type="heatmap"</code>; when <code>return_type="list"</code> it
returns a <code>list</code> with components used in the heatmap, perhaps
most important is the actual expression data matrix after
expression centering, expression filtering, and sample
subsetting operations, as relevant. The <code>list</code> also includes
the Heatmap under element <code>"hm"</code>, so it can be plotted
using <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html'>ComplexHeatmap::draw()</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes proteinatlas expression data <code>expr</code>,
and creates a heatmap of expression using a subset of
genes provided as <code>genes</code>.</p>
<p>By default, columns in <code>expr</code> are split by type, where
<code><a href='https://rdrr.io/r/base/colnames.html'>colnames(expr)</a></code> are expected to have suffix <code>" - Type"</code>
at the end of each column name. If the columns cannot be
split accordingly, then all columns are assigned one
split name <code>"Expression"</code>.</p>
<p>To customize data for individual samples, the <code>expr</code> data
should be filtered before calling this function.</p>
<p>By default, the row-centering method centers each row by
the row minimum expression using only <code>"Tissue"</code> samples,
so that expression will be displayed relative to the
lowest tissue expression. An optional set of control samples
can be provided with argument <code>controlSamples</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>test_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DKK1"</span>,<span class='st'>"DKK4"</span>,<span class='st'>"CXCL12"</span>,<span class='st'>"IL6R"</span>,<span class='st'>"MET"</span>,
   <span class='st'>"HK2"</span>,<span class='st'>"FTL"</span>,<span class='st'>"FTH1"</span>,<span class='st'>"STAT1"</span>,<span class='st'>"STAT3"</span>,<span class='st'>"CDKN1B"</span><span class='op'>)</span>;
<span class='fu'>proteinatlas_heatmap</span><span class='op'>(</span>genes<span class='op'>=</span><span class='va'>test_genes</span>,
   type<span class='op'>=</span><span class='st'>"Blood"</span>,
   centered<span class='op'>=</span><span class='cn'>FALSE</span>,
   cluster_rows<span class='op'>=</span><span class='cn'>TRUE</span>,
   cluster_columns<span class='op'>=</span><span class='cn'>TRUE</span>,
   row_filter<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='proteinatlas_heatmap-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># use proteinatlas_genesets_fdb11</span>
<span class='va'>use_im</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"secreted_proteins"</span>,
   <span class='st'>"membrane_proteins"</span>,
   <span class='st'>"NOT_membrane_secreted"</span>,
   <span class='st'>"TFs"</span><span class='op'>)</span>;
<span class='va'>proteinatlas_im</span> <span class='op'>&lt;-</span> <span class='fu'><a href='list2im_opt.html'>list2im_opt</a></span><span class='op'>(</span><span class='va'>proteinatlas_genesets_fdb11</span><span class='op'>[</span><span class='va'>use_im</span><span class='op'>]</span><span class='op'>)</span>;
<span class='va'>test_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DKK1"</span>,<span class='st'>"DKK4"</span>,<span class='st'>"CXCL12"</span>,<span class='st'>"IL6R"</span>,<span class='st'>"MET"</span>,
   <span class='st'>"HK2"</span>,<span class='st'>"FTL"</span>,<span class='st'>"FTH1"</span>,<span class='st'>"STAT1"</span>,<span class='st'>"STAT3"</span>,<span class='st'>"CDKN1B"</span><span class='op'>)</span>;
<span class='fu'>proteinatlas_heatmap</span><span class='op'>(</span>genes<span class='op'>=</span><span class='va'>test_genes</span>,
   type<span class='op'>=</span><span class='st'>"Blood"</span>,
   centered<span class='op'>=</span><span class='cn'>TRUE</span>,
   gene_im<span class='op'>=</span><span class='va'>proteinatlas_im</span><span class='op'>)</span>;
</div><div class='img'><img src='proteinatlas_heatmap-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


